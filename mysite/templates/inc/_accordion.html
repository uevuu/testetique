{% load testik_tags %}
<form action="" method="get">
    <div class="accordion" id="accordionPanelsStayOpenExample">
        <div class="accordion-item">
            <div align="center">
                <button class="btn btn-primary" type="submit">Применить фильтр(ы)</button>
            </div>
        </div>
        {% get_categories as categories %}
        {% for category in categories %}
        <div class="accordion-item">
            <h2 class="accordion-header" id="panelsStayOpen-heading{{category.id}}">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapse{{category.id}}" aria-expanded="false"
                        aria-controls="panelsStayOpen-collapse{{category.id}}">
                    <input class="form-check-input me-1" type="checkbox" name="category" value="{{category.id}}">
                    <a>{{category.title}}</a>
                </button>
            </h2>
            <div id="panelsStayOpen-collapse{{category.id}}" class="accordion-collapse collapse"
                 aria-labelledby="panelsStayOpen-heading{{category.id}}">
                <div class="accordion-body">
                    <div class="list-group">
                        {% get_child_categories category.id as child_categories %}
                        {% for child_category in child_categories %}
                        <label class="list-group-item">
                            <input class="form-check-input me-1" type="checkbox" name="category"
                                   value="{{child_category.id}}">
                            <a>{{child_category.title}}</a>
                        </label>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</form>